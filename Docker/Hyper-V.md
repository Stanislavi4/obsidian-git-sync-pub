Содержание

1. 1. [Что такое Hyper-V](https://blog.skillfactory.ru/glossary/hyper-v/#что-такое-hyperv)
2. 2. [История развития](https://blog.skillfactory.ru/glossary/hyper-v/#история-развития)
3. 3. [Архитектура](https://blog.skillfactory.ru/glossary/hyper-v/#архитектура)
4. 4. [Возможности](https://blog.skillfactory.ru/glossary/hyper-v/#возможности)
5. 5. [Преимущества](https://blog.skillfactory.ru/glossary/hyper-v/#преимущества)

Hyper-V — нативная (встроенная в ОС) платформа для аппаратной виртуализации, разработанная компанией Microsoft на основе Virtual PC, продукта дочерней компании Apple Connectix. Она позволяет создавать на одном физическом сервере несколько параллельно работающих изолированных программных окружений. Первоначально Hyper-V использовалась для виртуализации серверов, но, начиная с Windows 8, доступна для клиентской версии операционной системы. 

![Архитектура Hyper-V](https://lh5.googleusercontent.com/tyu6MlAEBweN1FJ1mt4fz_UPS5cvGnaIwls2XyYbNGZGTK36YGjkIO1Mw4oAK8keJmZCiK7g8D-GfKrASWGizJ2pfbYY8YaZPh2GeM5ysnnRoAuyoqwXHOuFG10lFC2yxrQeV5EZKUTbTRxfCBN4waW1wc9eHdeU)

Архитектура гипервизора Hyper-V. [Источник](https://commons.wikimedia.org/wiki/File:Viridian_Architecture.svg?uselang=ru)

## Что такое Hyper-V

Для понимания функций и назначения Hyper-V необходимо разобраться, что представляет собой технология виртуализации. 

Если коротко, то виртуализация — программная имитация работы полноценного ПК со своей операционной системой, жестким диском, оперативной памятью, процессором на выделенных мощностях физического компьютера. Для этого часть ресурсов физической платформы выделяется под работу виртуальной машины, а чтобы они не конфликтовали друг с другом, вторую запускают в изолированной программной среде. Виртуализация используется для решения различных задач:

- **эффективного использования аппаратных ресурсов** — например, с помощью нее можно запустить несколько виртуальных машин на сервере под отдельные сайты, что позволит снизить стоимость хостинговых услуг, так как основной ПК не будет работать вхолостую; 
- **пробной установки новой операционной системы** — например, если пользователь решил перейти на новую ОС, но пока не готов отказаться от старой или хочет использовать обе системы сразу под разные задачи;
- **тестирования новых программных продуктов или игр** — например, если разработчик хочет распространять свою продукцию среди пользователей других операционных систем;
- **экспериментов в области информационной безопасности** — запустив изолированную виртуальную машину, специалист может «заражать» ее вирусами, троянами и другим вредоносным ПО без риска повредить основную ОС и потерять хранящиеся на ней данные;
- **использования программного обеспечения** — в частности, на компьютере с основной системой Windows пользователь может с помощью виртуальной машины применять ПО, разработанное под Linux.

Виртуализация бывает двух типов:

- программной — когда аппаратные ресурсы для одной или нескольких виртуальных машин выделяются операционной системой физической платформы. Это, с одной стороны, упрощает виртуализацию, с другой — замедляет работу виртуальных систем. Кроме того, чтобы они нормально работали, их ОС должны поддерживать ядро основной операционной системы;
- аппаратной — в этом случае распределение физических ресурсов ПК между установленными на нем виртуальными платформами происходит напрямую, минуя основную (серверную) операционную систему. Это позволяет запускать на виртуальных машинах свои полноценные ОС (в том числе не поддерживающие ядро основной операционной системы).

Создание изолированной виртуальной среды и распределение аппаратных ресурсов между основной и гостевыми ОС — одна из главных задач, которую нужно решить для успешной виртуализации. Эти функции берет на себя программа-гипервизор, представляющая собой своеобразную операционную систему.  

Hyper-V — аппаратный гипервизор — программа-посредник между виртуальной машиной и самим «железом» компьютера. По сути, это своеобразная операционная система (микроядро), которая выполняет следующие функции:

- параллельную и независимую работу нескольких виртуальных машин на одном хост-компьютере;
- изолирование гостевых операционных систем друг от друга и основной ОС для предотвращения конфликтов;
- распределение аппаратных ресурсов между виртуальными машинами и управление ими;
- обеспечение взаимодействия между гостевыми ОС (обмен файлами, сетевое соединение и т.д.).

Иными словами, виртуализация в Hyper-V создает условия, при которых аппаратные ресурсы физической платформы эффективно распределяются между установленными на ней виртуальными операционными системами.

## История развития

В начале 2000-х годов корпорация Microsoft искала новые направления для своего развития, одним из которых стала разработка различных серверных решений. В 2003 году она поглотила дочернюю компанию Apple Connectix, от которой ей по наследству перешли права на программу Virtual PC. Это программное обеспечение уже на тот момент могло на равных конкурировать с продуктами лидера рынка виртуализации — корпорацией VMware. 

На основе Virtual PC в 2004 году Microsoft представила Virtual Server 2005 — решение для создания и управления виртуальными машинами в Windows. Впоследствии компания несколько изменила свой подход к этому продукту, и в 2008 году выпустила первую версию Hyper-V как компонента, по умолчанию входящего в состав новой на тот момент серверной операционной системы Windows Server.  

Сегодня Hyper-V поставляется корпорацией Microsoft в двух версиях:

- Hyper-V Server — отдельный программный продукт, который можно скачать с официального сайта Microsoft в виде ISO-файла (виртуального образа диска);
- вложенная виртуализация в составе серверных операционных систем Windows Server, а также 64-разрадных клиентских Windows 8, 10, 11 версий Pro (профессиональная), Enterprise (корпоративная) и Education (для образовательных учреждений). В домашней версии ОС этот компонент не предусмотрен. 

## Архитектура

Виртуализация в Windows с использованием Hyper-V основана на разделах. Так называется логическая единица разграничения, в которой работают операционные системы. Такие разделы (партиции) бывают двух типов:

- родительские. В разделах этого типа находится основная операционная система, управляющая физической платформой, а также запускается стек виртуализации;
- дочерние. Такие разделы создаются параллельно родительскому и изолированно от него и друг друга с помощью API-гипервизора Hyper-V. Именно в них устанавливаются гостевые операционные системы. 

Дочерние разделы не имеют прямого доступа к аппаратным ресурсам физической платформы. Вместо этого гипервизор предоставляет им виртуальное представление этих ресурсов (виртуальные устройства). Во время работы гостевая ОС обращается именно к своему виртуальному устройству, затем гипервизор перенаправляет ее запрос с помощью технологии VMbus (шины виртуальных устройств) хостовой операционной системе. И уже она передает все обращения гостевых ОС непосредственно драйверам аппаратной платформы. 

В этом заключается ключевое отличие Hyper-V от основного конкурента — гипервизора VMware ESX. Последний имеет встроенные аппаратные драйверы, в то время как Hyper-V задействует драйверы хостовой операционной системы. У каждого подхода есть свои преимущества.

- С одной стороны, наличие аппаратных драйверов в самом гипервизоре позволяет ему работать без хостовой ОС, по сути, заменяя ее. Также это ускоряет работу гостевых операционных систем, направляя запросы от них напрямую «железу». 
- С другой стороны, обращаясь к аппаратным драйверам операционной системы, гипервизор становится менее зависимым от архитектуры самой физической платформы. Например, если появляется драйвер для какой-то специфичной функции физической платформы, достаточно просто установить его в хостовую ОС, а не ждать выхода новой версии гипервизора с соответствующей поддержкой. 

Hyper-V позволяет создавать несколько уровней виртуализации — то есть дочерние разделы с установленными в них гостевыми ОС сами становятся родительскими для новых дочерних разделов. В этом случае обращение гостевых операционных систем к аппаратным ресурсам проходит последовательно через все ступени деления до того момента, как достигнут основной операционной системы, непосредственно управляющей операционной системой. Для повышения эффективности вложенной виртуализации в Hyper-V предусмотрена технология прогрессивного ввода-вывода, позволяющая гостевым ОС напрямую взаимодействовать с шиной виртуальных устройств. Однако, чтобы данная функция работала, гостевая операционная система должна иметь ее встроенную поддержку.    

## Возможности

Hyper-V дает пользователю множество возможностей для создания виртуальных машин и обеспечения контроля над ними. К основным функциям относятся:

- **Вычислительная среда.** В Hyper-V каждая виртуальная машина представляет собой эмуляцию полноценного компьютера со своими вычислительными ресурсами — пространством жесткого диска, оперативной памятью, центральным и графическим процессором, сетевым подключением для обмена данными и т.д. Все эти характеристики пользователь может настроить самостоятельно в соответствии с требованиями конкретной задачи. 
- **Восстановление данных.** Hyper-V позволяет восстановить данные в случае ошибки в работе виртуальной машины. Для этого программа автоматически создает копии виртуальных машин на другой физической платформе. Также в Hyper-V предусмотрено резервное копирование данных с помощью сохраненных состояний или службы теневого копирования томов (VSS). 
- **Оптимизация работы виртуальных машин.** Для каждой гостевой ОС, установленной на физической платформе, имеется отдельный набор настраиваемых драйверов и сетевых служб. Это упрощает интеграцию виртуальной машины с аппаратным обеспечением (физической платформой).
- **Переносимость**. В Hyper-V реализованы различные функции (динамическая миграция, перенос хранилища, импорт и экспорт файлов и т.д.), позволяющие перенести или дублировать виртуальную машину на другую физическую платформу.    
- **Удаленное подключение.** Hyper-V предлагает пользователям возможность удаленно контролировать виртуальную машину. Эта функция предусмотрена как для Windows, так и для Linux. Она подразумевает консольный доступ в отличие от удаленного рабочего стола, то есть пользователь может наблюдать происходящее в гостевой ОС, даже если основная операционная система еще не загружена. 
- **Безопасность.** В Hyper-V реализованы различные средства, обеспечивающие безопасное функционирование виртуальных машин. К ним относятся, например, экранирование, предотвращающее распространение вредоносного ПО с одной виртуальной машины на остальные или на основную ОС, подключение к резервному серверу или автономный режим при нарушении подключения к защите ресурсов узла, функция устранения неполадок, шифрование диска в гостевой операционной системе и т.д. 

## Преимущества

**Нативность.** В операционных системах семейства Windows Hyper-V является встроенным компонентом. То есть владельцам этих ОС не нужно отдельно скачивать и устанавливать программу, достаточно просто включить ее через раздел «Параметры». Кроме того, нативность обеспечивает полную совместимость Hyper-V с перечисленными системами и, следовательно, стабильную виртуализацию.

**Простота.** Hyper-V имеет простой и интуитивно-понятный интерфейс со множеством функций. Это позволяет пользователю быстро создать виртуальные разделы на аппаратной платформе, легко управлять ими и распределять ресурсы между гостевыми ОС.

**Возможность шифрования виртуальных машин.** Эта функция защищает данные, размещенные на виртуальных дисках. Доступ к ним не имеет даже администратор хоста, что особенно полезно при публичном размещении виртуальных машин.

**Удаленное управление в Hyper-v.** Помимо уже упоминавшегося управления посредством консоли, этот гипервизор позволяет создавать удаленные рабочие столы. Функция полезна, например, при работе нескольких сотрудников над одним проектом. 

**Аппаратная совместимость.** Hyper-V поддерживает работу с различными аппаратными платформами на базе процессоров Intel и AMD, включая самое современное «железо». 

**Программная совместимость.** Виртуальные машины в Hyper-V могут работать под управлением операционных систем семейства Windows (Server, 8, 10, 11 версий Pro, Enterprise, Education), Linux (Ubuntu, Debian, Oracle и т. д.), UNIX (FreeBSD).

Недостатков у Hyper-V немного:

- отсутствие поддержки ПО от сторонних разработчиков;
- меньшая функциональность и эффективность работы в сравнении с конкурентами KMV и VMware:
- обязательное наличие лицензионной серверной ОС Windows Server.

Таким образом, Hyper-V является на сегодняшний день одной из самых популярных платформ для виртуализации, которая используется для выполнения различных задач, от создания виртуальных серверов до разработки ПО. Простота и широкий набор возможностей делают ее предпочтительной не только для профессионалов, но и тех, кто только хочет попробовать свои силы в создании виртуальных машин.